# iOS PWA 缓存清理指南

## 问题现象
离开局域网后，PWA显示"Safari浏览器打不开网页，因为服务器已停止响应"

## 解决步骤

### 方法1：删除并重新添加PWA（推荐）

#### 步骤1：删除当前PWA
1. 在iOS主屏幕上找到应用图标
2. 长按应用图标，选择"删除App"
3. 确认删除

#### 步骤2：清理Safari缓存
1. 打开iOS"设置"
2. 滚动到"Safari"
3. 点击"清除历史记录与网站数据"
4. 确认清除

#### 步骤3：重新添加PWA
1. 使用新的部署地址（如Netlify）
2. 在Safari中打开应用
3. 点击分享按钮 → "添加到主屏幕"
4. 确认添加

### 方法2：手动清理特定网站数据

#### 步骤1：清理网站数据
1. 设置 → Safari → 高级 → 网站数据
2. 找到应用域名（如localhost或IP地址）
3. 左滑删除该网站数据

#### 步骤2：清理离线文件
1. 设置 → Safari → 高级 → 网站数据
2. 删除所有相关的缓存数据

### 方法3：强制刷新Service Worker

#### 在Safari中：
1. 打开应用网址
2. 长按刷新按钮
3. 选择"重新加载页面"
4. 再次添加到主屏幕

## 预防措施

### 1. 使用稳定的部署地址
- 使用Netlify、Vercel等云平台
- 避免使用localhost或局域网IP

### 2. 正确的PWA配置
- 确保manifest.json配置正确
- 使用适当的Service Worker缓存策略

### 3. 网络环境说明
- 开发环境：仅限局域网访问
- 生产环境：任何网络都可访问

## 部署建议

### 推荐部署平台：
1. **Netlify**（免费、简单）
   - 域名：`your-app.netlify.app`
   - 特点：自动HTTPS、CDN加速

2. **Vercel**（免费、快速）
   - 域名：`your-app.vercel.app`
   - 特点：零配置部署

3. **GitHub Pages**（免费）
   - 域名：`username.github.io/repo`
   - 特点：与GitHub集成

### 立即解决：
1. 运行 `deploy-netlify.bat` 部署到云端
2. 或运行 `start-static-server.bat` 启动本地服务器
3. 使用新地址重新添加PWA

## 技术说明

### PWA缓存机制：
- Service Worker缓存应用资源
- IndexedDB存储用户数据（视频文件）
- 视频文件不依赖网络，存储在本地

### 网络环境影响：
- 应用界面：需要稳定的网络访问
- 视频数据：存储在本地，不受网络影响
- 功能完整性：离线时仍可播放已缓存的视频

---

**总结：视频数据不会丢失，只需要重新部署应用到稳定的网络环境即可。**
