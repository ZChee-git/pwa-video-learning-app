# 视频播放器调试工具

## 功能概述

为了方便在PWA缓存清除后快速测试视频播放器功能，我添加了一个临时调试工具。这个工具可以在不需要重新创建播放列表和添加文件的情况下，直接生成测试数据来调试播放器。

## 启动调试工具

### 方式1：通过调试按钮（推荐）
当localStorage中没有视频和播放列表数据时，会在页面右上角显示一个设置按钮⚙️，点击即可打开调试工具。

### 方式2：双击标题
双击页面标题"艾宾浩斯视频学习系统"也可以打开调试工具（任何时候都可以使用）。

## 调试工具功能

### 1. 生成测试数据
- **在线测试视频**：使用在线示例视频URL生成测试数据
- **真实文件测试**：上传本地视频文件进行真实测试

### 2. 数据预览
- 显示生成的调试视频数量
- 显示调试播放列表项目数量
- 预览每个视频的基本信息和复习类型

### 3. 播放器测试
- 一键启动视频播放器
- 使用生成的测试数据进行完整的播放器功能测试
- 支持所有播放器功能：播放、暂停、切换、进度保存等

### 4. 数据管理
- **保存到存储**：将调试数据保存到localStorage供后续使用
- **清理数据**：清除生成的调试数据和blob URLs

## 使用场景

### 1. PWA缓存清除后
1. 删除PWA缓存数据
2. 重新加载应用
3. 点击调试按钮或双击标题
4. 选择生成测试数据的方式
5. 启动播放器测试

### 2. 功能开发测试
1. 双击页面标题打开调试工具
2. 上传几个测试视频文件
3. 启动播放器测试新功能
4. 测试完成后清理数据

### 3. 播放进度功能测试
1. 生成测试数据并启动播放器
2. 播放一段时间后关闭播放器
3. 重新打开播放器测试进度恢复功能
4. 验证继续播放提示是否正常工作

## 测试数据结构

### 生成的测试视频
```javascript
{
  id: 'debug-video-1',
  name: '测试视频1 - 风景.mp4',
  file: File对象或null,
  fileUrl: 'blob:...' 或 'https://...',
  dateAdded: new Date(),
  reviewCount: 0,
  status: 'new',
  collectionId: 'debug-collection-1'
}
```

### 生成的播放列表
```javascript
{
  videoId: 'debug-video-1',
  reviewType: 'new',
  reviewNumber: 1,
  daysSinceFirstPlay: 0
}
```

## 注意事项

### 1. 数据清理
- 使用真实文件测试后，记得点击"清理数据"按钮
- 这会释放blob URLs，避免内存泄漏

### 2. 在线测试视频
- 在线测试视频需要网络连接
- 如果网络不佳，建议使用本地文件测试

### 3. 调试工具的临时性
- 这是一个临时调试工具，不会影响正常的应用功能
- 调试完成后可以正常使用应用的其他功能

## 技术实现

### 1. 条件显示
```typescript
{(videos.length === 0 && playlists.length === 0) && (
  <button onClick={() => setShowDebugTool(true)}>
    调试工具
  </button>
)}
```

### 2. 双击事件
```typescript
<h1 
  onDoubleClick={() => setShowDebugTool(true)}
  title="双击打开调试工具"
>
  艾宾浩斯视频学习系统
</h1>
```

### 3. 文件处理
```typescript
const handleFileUpload = (event: React.ChangeEvent<HTMLInputElement>) => {
  const files = event.target.files;
  // 生成blob URLs和测试数据
  const fileUrl = URL.createObjectURL(file);
  // ...
};
```

## 调试流程示例

1. **清除缓存**
   - 在浏览器中清除PWA缓存
   - 或者手动清除localStorage数据

2. **启动调试工具**
   - 重新加载应用
   - 点击右上角的⚙️按钮

3. **生成测试数据**
   - 选择"上传真实文件测试"
   - 选择2-3个测试视频文件
   - 查看生成的数据预览

4. **测试播放器**
   - 点击"启动播放器测试"
   - 测试播放、暂停、切换等功能
   - 测试播放进度保存和恢复

5. **清理数据**
   - 测试完成后点击"清理数据"
   - 释放内存和blob URLs

这个调试工具大大简化了开发和测试过程，特别是在PWA环境下频繁清除缓存的情况下。
